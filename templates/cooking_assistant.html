{% extends "base.html" %}

{% block title %}Asistente de Cocina - Sistema Experto Culinario{% endblock %}

{% block content %}
<div class="container py-4">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card bg-gradient text-white" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);">
                <div class="card-body text-center py-5">
                    <h1 class="display-5 fw-bold mb-3">
                        <i class="fas fa-robot me-3"></i>
                        Asistente de Cocina Inteligente
                    </h1>
                    <p class="lead mb-0">
                        Tu chef personal con IA avanzada para t√©cnicas, recetas y consejos culinarios
                    </p>
                </div>
            </div>
        </div>
    </div>
    
    <div class="row">
        <!-- Chat Principal -->
        <div class="col-lg-8">
            <div class="card h-100">
                <div class="card-header bg-success text-white">
                    <div class="d-flex align-items-center">
                        <div class="flex-shrink-0">
                            <div class="avatar bg-white text-success rounded-circle d-flex align-items-center justify-content-center" 
                                 style="width: 40px; height: 40px;">
                                <i class="fas fa-robot"></i>
                            </div>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <h5 class="mb-0">Chef AI Master</h5>
                            <small class="opacity-75">
                                <span class="status-indicator"></span> Especialista en t√©cnicas culinarias
                            </small>
                        </div>
                        <div class="flex-shrink-0">
                            <button class="btn btn-outline-light btn-sm" onclick="clearChat()">
                                <i class="fas fa-broom"></i> Limpiar
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- √Årea de chat -->
                <div class="card-body d-flex flex-column" style="height: 500px;">
                    <div id="chat-messages" class="flex-grow-1 overflow-auto mb-3">
                        <!-- Mensaje de bienvenida -->
                        <div class="message bot-message">
                            <div class="d-flex mb-3">
                                <div class="flex-shrink-0">
                                    <div class="avatar bg-success text-white rounded-circle d-flex align-items-center justify-content-center" 
                                         style="width: 35px; height: 35px;">
                                        <i class="fas fa-robot"></i>
                                    </div>
                                </div>
                                <div class="flex-grow-1 ms-3">
                                    <div class="bg-light rounded p-3">
                                        <p class="mb-2">¬°Hola! Soy tu Chef AI Master especializado en t√©cnicas culinarias. üë®‚Äçüç≥‚ú®</p>
                                        <p class="mb-0"><strong>Puedo ayudarte con:</strong></p>
                                        <ul class="mb-0 mt-2">
                                            <li><strong>T√©cnicas culinarias:</strong> sofrito, braseado, confitado, etc.</li>
                                            <li><strong>M√©todos de cocci√≥n:</strong> al vapor, en papillote, sous vide</li>
                                            <li><strong>Cortes de cuchillo:</strong> juliana, brunoise, chiffonade</li>
                                            <li><strong>Recomendaciones de recetas</strong> seg√∫n ingredientes</li>
                                            <li><strong>Informaci√≥n nutricional</strong> y sustitutos</li>
                                            <li><strong>Troubleshooting:</strong> c√≥mo arreglar errores en cocina</li>
                                        </ul>
                                        <p class="mt-2 mb-0"><em>üí° Preg√∫ntame espec√≠ficamente sobre cualquier t√©cnica o m√©todo!</em></p>
                                    </div>
                                    <small class="text-muted">Hace un momento</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Input de mensaje -->
                    <div class="input-group">
                        <input type="text" 
                               id="message-input" 
                               class="form-control" 
                               placeholder="Ej: ¬øC√≥mo hacer un sofrito perfecto? ¬øQu√© es el braseado?"
                               onkeypress="handleKeyPress(event)">
                        <button class="btn btn-success" onclick="sendMessage()" id="send-btn">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Sidebar con sugerencias -->
        <div class="col-lg-4">
            <!-- T√©cnicas Culinarias -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-fire text-danger me-2"></i>
                        T√©cnicas Culinarias
                    </h5>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <button class="btn btn-outline-primary btn-sm text-start" 
                                onclick="quickQuestion('¬øC√≥mo hacer un sofrito perfecto?')">
                            üßÑ ¬øC√≥mo hacer un sofrito perfecto?
                        </button>
                        <button class="btn btn-outline-primary btn-sm text-start" 
                                onclick="quickQuestion('¬øQu√© es el braseado y c√≥mo se hace?')">
                            üçñ ¬øQu√© es el braseado y c√≥mo se hace?
                        </button>
                        <button class="btn btn-outline-primary btn-sm text-start" 
                                onclick="quickQuestion('¬øC√≥mo hacer un roux para salsas?')">
                            ü•Ñ ¬øC√≥mo hacer un roux para salsas?
                        </button>
                        <button class="btn btn-outline-primary btn-sm text-start" 
                                onclick="quickQuestion('¬øCu√°les son los cortes b√°sicos de cuchillo?')">
                            üî™ Cortes b√°sicos de cuchillo
                        </button>
                        <button class="btn btn-outline-primary btn-sm text-start" 
                                onclick="quickQuestion('¬øC√≥mo hacer una salsa madre bechamel?')">
                            ü•õ Salsa madre bechamel
                        </button>
                        <button class="btn btn-outline-primary btn-sm text-start" 
                                onclick="quickQuestion('¬øQu√© es el m√©todo en papillote?')">
                            üìÑ Cocci√≥n en papillote
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- M√©todos de Cocci√≥n -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-thermometer-half text-info me-2"></i>
                        M√©todos de Cocci√≥n
                    </h5>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <button class="btn btn-outline-info btn-sm text-start" 
                                onclick="quickQuestion('¬øCu√°l es la diferencia entre hervir y pochar?')">
                            üíß Hervir vs Pochar
                        </button>
                        <button class="btn btn-outline-info btn-sm text-start" 
                                onclick="quickQuestion('¬øC√≥mo cocinar al vapor correctamente?')">
                            ‚ô®Ô∏è Cocci√≥n al vapor
                        </button>
                        <button class="btn btn-outline-info btn-sm text-start" 
                                onclick="quickQuestion('¬øQu√© temperaturas usar para asar?')">
                            üî• Temperaturas para asar
                        </button>
                        <button class="btn btn-outline-info btn-sm text-start" 
                                onclick="quickQuestion('¬øC√≥mo hacer un confitado perfecto?')">
                            ü¶Ü T√©cnica de confitado
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Troubleshooting -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-tools text-warning me-2"></i>
                        Soluci√≥n de Problemas
                    </h5>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <button class="btn btn-outline-warning btn-sm text-start" 
                                onclick="quickQuestion('Se me cort√≥ la mayonesa, ¬øc√≥mo la arreglo?')">
                            üò± Mayonesa cortada
                        </button>
                        <button class="btn btn-outline-warning btn-sm text-start" 
                                onclick="quickQuestion('Mi salsa est√° muy l√≠quida, ¬øc√≥mo la espeso?')">
                            üíß Espesar salsas
                        </button>
                        <button class="btn btn-outline-warning btn-sm text-start" 
                                onclick="quickQuestion('Se me quem√≥ la comida, ¬øpuedo salvarla?')">
                            üî• Comida quemada
                        </button>
                        <button class="btn btn-outline-warning btn-sm text-start" 
                                onclick="quickQuestion('La masa no levanta, ¬øqu√© hago?')">
                            üçû Problemas con masa
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Consejo del d√≠a -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-calendar-day text-info me-2"></i>
                        T√©cnica del D√≠a
                    </h5>
                </div>
                <div class="card-body">
                    <div class="text-center">
                        <i class="fas fa-cut fa-2x text-warning mb-3"></i>
                        <h6>Corte Brunoise</h6>
                        <p class="small text-muted mb-0">
                            Corte en dados de 1-2mm. Ideal para verduras arom√°ticas. 
                            T√©cnica: cortes paralelos ‚Üí perpendiculares ‚Üí transversales.
                        </p>
                        <button class="btn btn-outline-primary btn-sm mt-2" 
                                onclick="quickQuestion('¬øC√≥mo hacer el corte brunoise paso a paso?')">
                            Aprender t√©cnica
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Estado del asistente -->
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-graduation-cap text-info me-2"></i>
                        Chef AI Especializado
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row text-center g-3">
                        <div class="col-6">
                            <div class="bg-light rounded p-2">
                                <i class="fas fa-brain fa-lg text-primary"></i>
                                <div class="mt-1">
                                    <small class="fw-bold">IA Culinaria</small>
                                    <div class="small text-muted">Especializada</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="bg-light rounded p-2">
                                <i class="fas fa-book-open fa-lg text-success"></i>
                                <div class="mt-1">
                                    <small class="fw-bold">500+ T√©cnicas</small>
                                    <div class="small text-muted">Base de datos</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="bg-light rounded p-2">
                                <i class="fas fa-chef-hat fa-lg text-warning"></i>
                                <div class="mt-1">
                                    <small class="fw-bold">Chef Experto</small>
                                    <div class="small text-muted">Nivel Profesional</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="bg-light rounded p-2">
                                <i class="fas fa-language fa-lg text-info"></i>
                                <div class="mt-1">
                                    <small class="fw-bold">Espa√±ol</small>
                                    <div class="small text-muted">T√©cnico</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <hr>
                    
                    <div class="alert alert-info py-2 mb-0" role="alert">
                        <small>
                            <i class="fas fa-lightbulb me-1"></i>
                            <strong>Tip:</strong> Soy especialista en t√©cnicas culinarias profesionales. 
                            Preg√∫ntame sobre m√©todos espec√≠ficos, cortes, cocciones y soluciones a problemas.
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<!-- JavaScript corregido para el asistente de cocina -->
<script>
let messageCount = 0;

// BASE DE CONOCIMIENTO CULINARIO COMPLETA
const culinaryKnowledge = {
    // RECOMENDACIONES DE RECETAS
    'receta': {
        keywords: ['receta', 'cocinar', 'preparar', 'hacer', 'plato', 'comida'],
        response: `üçΩÔ∏è <strong>RECOMENDACIONES DE RECETAS:</strong><br><br>
                Para recomendarte recetas espec√≠ficas, dime:<br><br>
                ü•ò <strong>¬øQu√© ingredientes tienes?</strong><br>
                "Tengo pollo, arroz y verduras"<br><br>
                ‚è∞ <strong>¬øCu√°nto tiempo tienes?</strong><br>
                "Quiero algo r√°pido, 30 minutos m√°ximo"<br><br>
                üå∂Ô∏è <strong>¬øQu√© tipo de cocina prefieres?</strong><br>
                "Algo mediterr√°neo" o "Comida mexicana"<br><br>
                üí° <strong>Ejemplos espec√≠ficos:</strong><br>
                ‚Ä¢ "Receta con pollo y arroz para 4 personas"<br>
                ‚Ä¢ "Algo vegetariano y r√°pido"<br>
                ‚Ä¢ "Postre f√°cil para principiantes"<br><br>
                <em>¬°Dame detalles y te ayudo a encontrar la receta perfecta!</em>`
    },
    
    'pollo_arroz': {
        keywords: ['pollo arroz', 'arroz con pollo', 'pollo y arroz'],
        response: `üçó <strong>ARROZ CON POLLO PERFECTO:</strong><br><br>
                <strong>Ingredientes (4 personas):</strong><br>
                ‚Ä¢ 2 tazas arroz bomba<br>
                ‚Ä¢ 1 pollo troceado<br>
                ‚Ä¢ 1 cebolla grande<br>
                ‚Ä¢ 3 dientes ajo<br>
                ‚Ä¢ 1 pimiento rojo<br>
                ‚Ä¢ 2 tomates rallados<br>
                ‚Ä¢ Azafr√°n en hebras<br><br>
                <strong>T√©cnica profesional:</strong><br>
                1. <strong>Sofrito:</strong> Cebolla + ajo + pimiento (8 min)<br>
                2. <strong>Dorar pollo:</strong> 3 min por lado<br>
                3. <strong>Tomate:</strong> Hasta que pierda agua<br>
                4. <strong>Arroz:</strong> 3 min tostando<br>
                5. <strong>Caldo:</strong> 3 partes por 1 de arroz<br>
                6. <strong>Tiempo:</strong> 18-20 min sin remover<br><br>
                üî• <strong>Tip:</strong> √öltimos 2 min fuego alto para socarrat`
    },
    
    'pasta': {
        keywords: ['pasta', 'espagueti', 'fettuccine', 'penne'],
        response: `üçù <strong>PASTA PERFECTA:</strong><br><br>
                <strong>Regla 1-10-100:</strong><br>
                ‚Ä¢ 1L agua por 100g pasta<br>
                ‚Ä¢ 10g sal por litro<br>
                ‚Ä¢ 100g pasta por persona<br><br>
                <strong>T√©cnica italiana:</strong><br>
                1. <strong>Agua hirviendo vigorosa</strong><br>
                2. <strong>Sal cuando hierva</strong> (debe saber salada)<br>
                3. <strong>Pasta de una vez</strong><br>
                4. <strong>Al dente:</strong> -1 min del paquete<br>
                5. <strong>Mantecatura:</strong> Pasta + salsa + agua de cocci√≥n<br><br>
                üí´ <strong>Secreto:</strong> La mantecatura es clave para cremosidad`
    },
    
    'vegetariano': {
        keywords: ['vegetariano', 'sin carne', 'vegetal', 'verduras'],
        response: `ü•¨ <strong>RECETAS VEGETARIANAS:</strong><br><br>
                <strong>R√°pidas (20-30 min):</strong><br>
                ‚Ä¢ <strong>Pasta primavera:</strong> Verduras + pasta + aceite oliva<br>
                ‚Ä¢ <strong>Tacos de frijoles:</strong> Con guacamole casero<br>
                ‚Ä¢ <strong>Ensalada quinoa:</strong> Con verduras asadas<br><br>
                <strong>Nutritivas:</strong><br>
                ‚Ä¢ <strong>Curry lentejas:</strong> Rico en prote√≠na<br>
                ‚Ä¢ <strong>Risotto champi√±ones:</strong> Cremoso y umami<br>
                ‚Ä¢ <strong>Buddha bowl:</strong> Quinoa + verduras<br><br>
                üßÑ <strong>Tips:</strong> Sofrito potente + especias tostadas`
    },
    
    'postre': {
        keywords: ['postre', 'dulce', 'dessert'],
        response: `üç∞ <strong>POSTRES F√ÅCILES:</strong><br><br>
                <strong>Sin horno (30 min):</strong><br>
                ‚Ä¢ <strong>Tiramis√∫:</strong> Solo 4 ingredientes<br>
                ‚Ä¢ <strong>Mousse chocolate:</strong> 3 ingredientes<br>
                ‚Ä¢ <strong>Flan casero:</strong> T√©cnica infalible<br><br>
                <strong>Con horno (45 min):</strong><br>
                ‚Ä¢ <strong>Brownies:</strong> H√∫medos y fudgy<br>
                ‚Ä¢ <strong>Cookies:</strong> Crujientes por fuera<br>
                ‚Ä¢ <strong>Muffins:</strong> Esponjosos perfectos<br><br>
                üç´ <strong>¬øQu√© tipo de postre prefieres?</strong>`
    },
    
    // T√âCNICAS CULINARIAS
    'sofrito': {
        keywords: ['sofrito', 'sofreir', 'base arom√°tica'],
        response: `üßÑ <strong>SOFRITO PERFECTO:</strong><br><br>
                1. <strong>Fuego medio-bajo</strong><br>
                2. <strong>Orden:</strong> Cebolla ‚Üí Ajo ‚Üí Tomate<br>
                3. <strong>Tiempos:</strong> Cebolla 7min, Ajo 1min<br>
                4. <strong>Paciencia:</strong> No quemar el ajo<br><br>
                ‚ö†Ô∏è <strong>Error com√∫n:</strong> Fuego alto arruina todo`
    }
};

// Enviar mensaje - FUNCI√ìN CORREGIDA
function sendMessage() {
    const input = document.getElementById('message-input');
    const message = input.value.trim();
    
    if (!message) {
        console.log('‚ùå Mensaje vac√≠o');
        return;
    }
    
    console.log('üì§ Enviando mensaje:', message);
    
    // Agregar mensaje del usuario
    addMessage('user', message);
    
    // Limpiar input y mostrar loading
    input.value = '';
    setLoading(true);
    
    // Generar respuesta del bot
    setTimeout(() => {
        const response = generateAdvancedResponse(message);
        addMessage('bot', response);
        setLoading(false);
        input.focus(); // Devolver foco al input
    }, 800 + Math.random() * 400);
}

// Agregar mensaje al chat
function addMessage(sender, content) {
    const chatMessages = document.getElementById('chat-messages');
    const isBot = sender === 'bot';
    
    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${isBot ? 'bot-message' : 'user-message'}`;
    
    const time = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
    
    if (isBot) {
        messageDiv.innerHTML = `
            <div class="d-flex mb-3">
                <div class="flex-shrink-0">
                    <div class="avatar bg-success text-white rounded-circle d-flex align-items-center justify-content-center" 
                         style="width: 35px; height: 35px;">
                        <i class="fas fa-robot"></i>
                    </div>
                </div>
                <div class="flex-grow-1 ms-3">
                    <div class="bg-light rounded p-3">
                        ${content}
                    </div>
                    <small class="text-muted">${time}</small>
                </div>
            </div>
        `;
    } else {
        messageDiv.innerHTML = `
            <div class="d-flex mb-3 justify-content-end">
                <div class="flex-grow-1 me-3 text-end">
                    <div class="bg-primary text-white rounded p-3">
                        ${content}
                    </div>
                    <small class="text-muted">${time}</small>
                </div>
                <div class="flex-shrink-0">
                    <div class="avatar bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" 
                         style="width: 35px; height: 35px;">
                        <i class="fas fa-user"></i>
                    </div>
                </div>
            </div>
        `;
    }
    
    chatMessages.appendChild(messageDiv);
    chatMessages.scrollTop = chatMessages.scrollHeight;
    messageCount++;
}

// Generar respuesta avanzada del bot
function generateAdvancedResponse(message) {
    const msg = message.toLowerCase();
    
    console.log('ü§ñ Procesando mensaje:', msg);
    
    // BUSCAR RECOMENDACIONES DE RECETAS PRIMERO
    if (msg.includes('receta') || msg.includes('cocinar') || msg.includes('preparar') || msg.includes('hacer')) {
        // Recomendaciones espec√≠ficas por ingredientes
        if ((msg.includes('pollo') && msg.includes('arroz')) || msg.includes('arroz con pollo')) {
            return culinaryKnowledge['pollo_arroz'].response;
        }
        
        if (msg.includes('pasta') || msg.includes('espagueti')) {
            return culinaryKnowledge['pasta'].response;
        }
        
        if (msg.includes('vegetariano') || msg.includes('sin carne') || msg.includes('vegetal')) {
            return culinaryKnowledge['vegetariano'].response;
        }
        
        if (msg.includes('postre') || msg.includes('dulce')) {
            return culinaryKnowledge['postre'].response;
        }
        
        // Recomendaciones generales
        return culinaryKnowledge['receta'].response;
    }
    
    // BUSCAR EN T√âCNICAS CULINARIAS
    for (const [key, data] of Object.entries(culinaryKnowledge)) {
        if (data.keywords && data.keywords.some(keyword => msg.includes(keyword))) {
            return data.response;
        }
    }
    
    // RESPUESTAS CONTEXTUALES
    if (msg.includes('ingredientes') || msg.includes('tengo')) {
        return `üìù <strong>¬°PERFECTO!</strong><br><br>
                Dime exactamente qu√© ingredientes tienes:<br><br>
                üìù <strong>Ejemplo:</strong><br>
                "Tengo pollo, arroz, cebolla, tomate y ajo"<br><br>
                ‚è∞ <strong>Tambi√©n dime:</strong><br>
                ‚Ä¢ ¬øPara cu√°ntas personas?<br>
                ‚Ä¢ ¬øCu√°nto tiempo tienes?<br>
                ‚Ä¢ ¬øAlguna preferencia especial?<br><br>
                üéØ <strong>As√≠ te dar√© la receta perfecta paso a paso!</strong>`;
    }
    
    if (msg.includes('tiempo') || msg.includes('r√°pido') || msg.includes('minutos')) {
        return `‚è∞ <strong>RECETAS POR TIEMPO:</strong><br><br>
                <strong>15 minutos:</strong><br>
                ‚Ä¢ Pasta aglio e olio<br>
                ‚Ä¢ Ensaladas completas<br>
                ‚Ä¢ Quesadillas gourmet<br><br>
                <strong>30 minutos:</strong><br>
                ‚Ä¢ Salteados de verduras<br>
                ‚Ä¢ Tacos caseros<br>
                ‚Ä¢ Arroz frito<br><br>
                <strong>45 minutos:</strong><br>
                ‚Ä¢ Pollo al horno<br>
                ‚Ä¢ Risotto cremoso<br><br>
                ‚è±Ô∏è <strong>¬øCu√°nto tiempo tienes exactamente?</strong>`;
    }
    
    // RESPUESTA POR DEFECTO
    const defaultResponses = [
        `üë®‚Äçüç≥ <strong>¬°Hola! Soy tu Chef AI!</strong><br><br>
         Puedo ayudarte con:<br><br>
         üçΩÔ∏è <strong>Recomendaciones de recetas:</strong><br>
         "Tengo pollo y arroz, ¬øqu√© puedo hacer?"<br><br>
         üîß <strong>T√©cnicas culinarias:</strong><br>
         "¬øC√≥mo hacer un sofrito perfecto?"<br><br>
         ‚ö†Ô∏è <strong>Soluci√≥n de problemas:</strong><br>
         "Se me cort√≥ la mayonesa"<br><br>
         üí° <strong>¬øEn qu√© te ayudo hoy?</strong>`,
        
        `üéØ <strong>Chef AI especializado</strong><br><br>
         <strong>Para recetas:</strong> Dime qu√© ingredientes tienes<br>
         <strong>Para t√©cnicas:</strong> Pregunta sobre m√©todos espec√≠ficos<br>
         <strong>Para problemas:</strong> Describe qu√© pas√≥<br><br>
         üìù <strong>Ejemplo:</strong><br>
         "Tengo pasta, tomate y ajo. Quiero algo para 2 personas en 20 minutos"<br><br>
         ü§ù <strong>¬°Estoy aqu√≠ para ayudarte a cocinar como un profesional!</strong>`
    ];
    
    return defaultResponses[Math.floor(Math.random() * defaultResponses.length)];
}

// Manejar Enter en el input - CORREGIDO
function handleKeyPress(event) {
    if (event.key === 'Enter') {
        event.preventDefault(); // Prevenir submit del form
        sendMessage();
    }
}

// Pregunta r√°pida - FUNCI√ìN A√ëADIDA
function quickQuestion(question) {
    console.log('‚ö° Pregunta r√°pida:', question);
    const input = document.getElementById('message-input');
    input.value = question;
    sendMessage();
}

// Limpiar chat
function clearChat() {
    const chatMessages = document.getElementById('chat-messages');
    // Mantener solo el mensaje de bienvenida
    const welcomeMessage = chatMessages.querySelector('.bot-message');
    chatMessages.innerHTML = '';
    if (welcomeMessage) {
        chatMessages.appendChild(welcomeMessage);
    }
    messageCount = 0;
    console.log('üßπ Chat limpiado');
}

// Estado de carga
function setLoading(loading) {
    const sendBtn = document.getElementById('send-btn');
    const input = document.getElementById('message-input');
    
    if (loading) {
        sendBtn.innerHTML = '<span class="spinner-border spinner-border-sm"></span>';
        sendBtn.disabled = true;
        input.disabled = true;
    } else {
        sendBtn.innerHTML = '<i class="fas fa-paper-plane"></i>';
        sendBtn.disabled = false;
        input.disabled = false;
        input.focus();
    }
}

// Inicializar cuando el DOM est√© listo
document.addEventListener('DOMContentLoaded', function() {
    console.log('üöÄ Inicializando asistente de cocina...');
    
    const input = document.getElementById('message-input');
    const sendBtn = document.getElementById('send-btn');
    
    if (input) {
        input.focus();
        console.log('‚úÖ Input encontrado y enfocado');
    } else {
        console.error('‚ùå Input no encontrado');
    }
    
    if (sendBtn) {
        console.log('‚úÖ Bot√≥n enviar encontrado');
    } else {
        console.error('‚ùå Bot√≥n enviar no encontrado');
    }
    
    // Mostrar mensaje de consejos despu√©s de 3 segundos
    setTimeout(() => {
        addMessage('bot', `
            <strong>üí° EJEMPLOS DE PREGUNTAS:</strong><br><br>
            üî• "Tengo pollo, arroz y cebolla. ¬øQu√© puedo cocinar?"<br>
            ü•© "¬øC√≥mo hacer un sofrito perfecto?"<br>
            üçù "Receta de pasta r√°pida para 2 personas"<br>
            üå± "Algo vegetariano y f√°cil"<br>
            üç∞ "Postre sin horno para principiantes"<br><br>
            <em>¬°Preg√∫ntame lo que necesites!</em>
        `);
    }, 3000);
});

// Debug: Verificar que todas las funciones est√©n definidas
console.log('üîß Funciones disponibles:', {
    sendMessage: typeof sendMessage,
    quickQuestion: typeof quickQuestion,
    handleKeyPress: typeof handleKeyPress,
    clearChat: typeof clearChat
});
</script>
{% endblock %}